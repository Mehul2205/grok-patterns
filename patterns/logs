METHOD ^(GET|PUT|POST|DELETE)
HOST [A-Za-z0-9\-\._~\/]*(:\d+)?
API_KEY [a-z0-9]+
ORG_ID [a-z0-9]{24}
BOOLEAN TRUE|FALSE|true|false


TAG_WITH_CUSTOMER_ID %{GREEDYDATA}cid_%{USERNAME:customer_id}%{GREEDYDATA}log_class-product:%{USER:product_line}%{GREEDYDATA}
TAG_WITH_TYK_HEADERS %{GREEDYDATA}x-bt-origin-%{HOSTNAME:gateway_host}%{GREEDYDATA}log_class-product:%{USER:product_line}%{GREEDYDATA}
TAG_WITH_TENANT_ID %{GREEDYDATA}tenant_id-%{USER:tenant_id}%{GREEDYDATA}log_class-product:%{USER:product_line}%{GREEDYDATA}
TAG_WITH_PRODUCT_LINE %{GREEDYDATA}log_class-product:%{USER:product_line}%{GREEDYDATA}
TAG_WITH_PORTAL_INFO %{GREEDYDATA};portal-org-%{INT:portal_org_id}%{GREEDYDATA};portal-app-%{INT:portal_app_id}%{GREEDYDATA}log_class-product:%{USER:product_line}%{GREEDYDATA}|%{GREEDYDATA};portal-app-%{INT:portal_app_id}%{GREEDYDATA};portal-org-%{INT:portal_org_id}%{GREEDYDATA}log_class-product:%{USER:product_line}%{GREEDYDATA}


CUSTOM_TIMESTAMP %{YEAR}-%{MONTHNUM}-%{MONTHDAY}[T ]%{HOUR}:?%{MINUTE}(?::?%{SECOND})? %{ISO8601_TIMEZONE}? %{TZ}

APIM_ANALYTICS_LOGS %{METHOD:method},%{HOST:upstream_host},%{URIPATH:path},%{URIPATH:raw_path},%{INT:content_length},%{GREEDYDATA:user_agent},%{INT:timestamp_date},%{MONTH:month},%{YEAR:year},%{INT:hour},%{INT:response_code},%{API_KEY:api_key},%{CUSTOM_TIMESTAMP:analytics_timestamp},%{GREEDYDATA:api_version},%{GREEDYDATA:api_name},%{GREEDYDATA:api_id},%{GREEDYDATA:organization_id},%{GREEDYDATA:oauth_id},%{INT},%{GREEDYDATA},%{GREEDYDATA},%{IP:ip_address},%{GREEDYDATA},%{INT},%{GREEDYDATA},%{INT},%{INT},%{GREEDYDATA},%{INT},%{INT},%{INT},%{INT},%{INT:latency_total},%{INT:latency_upstream},%{GREEDYDATA:tyk_tag},%{GREEDYDATA:alias},%{BOOLEAN},%{CUSTOM_TIMESTAMP},%{GREEDYDATA}

